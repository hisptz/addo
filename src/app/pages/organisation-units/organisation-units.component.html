<div *ngIf="selectedOrganisationUnitStatus$ | async">
  <mat-card>
    <!-- <h4>Selected Organisation unit:</h4> -->
    <p>Name: {{ (selectedOrganisationUnit$ | async).name }}</p>
    <p>Level: {{ (selectedOrganisationUnit$ | async).level }}</p>
    <h4 class="header">Facilities Not Reported in {{ (selectedOrganisationUnit$ | async).name }} for {{getMonth}}, {{getYear}}</h4>
  </mat-card>

  <div
    *ngIf="
      (organisationUnitChildrenLoaded$ | async) &&
      !(isLeafOrganisation$ | async)
    "
  >
    <table mat-table class="table table-hover">
      <thead class="thead-light">
        <tr>
          <th scope="col">S/N</th>
          <th scope="col">Name</th>
          <th scope="col">Last Updated</th>
          <th scope="col">Contact Person</th>
          <th scope="col">Dispenser's Contact</th>
          <th scope="col">Action</th>

          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="
            let orgunitChild of organisationUnitChildren$ | async;
            let count = index;
            index as i
          "
        >
          <td>{{ count + 1 }}</td>
          <td>{{ orgunitChild.name }}</td>
          <td>{{ orgunitChild.lastUpdated | date }}</td>
          <td *ngIf="orgunitChild.phoneNumber">
            <span *ngIf="enableEditIndex != i">{{
              orgunitChild.phoneNumber
            }}</span>
            <input
              type="text"
              [(ngModel)]="orgunitChild.phoneNumber"
              *ngIf="enableEdit && enableEditIndex == i"
              class="inputs"
            />
          </td>
          <td *ngIf="!orgunitChild.phoneNumber">
            <span *ngIf="enableEditIndex != i">No Contact Details</span>
            <input
              type="text"
              [(ngModel)]="!orgunitChild.phoneNumber"
              *ngIf="enableEdit && enableEditIndex == i"
              class="inputs"
            />
          </td>

          <td *ngIf="orgunitChild.attributeValues[0]">
            <span *ngIf="enableEditIndex != i">{{
              orgunitChild.attributeValues[0].value
            }}</span>
            <input
              type="text"
              [(ngModel)]="orgunitChild.attributeValues[0].value"
              *ngIf="enableEdit && enableEditIndex == i"
              class="inputs"
            />
          </td>
          <td *ngIf="!orgunitChild.attributeValues[0]">
            <span *ngIf="enableEditIndex != i">No Contact Details</span>
            <input
              type="text"
              [(ngModel)]="!orgunitChild.attributeValues[0]"
              *ngIf="enableEdit && enableEditIndex == i"
              class="inputs"
            />
          </td>

          <td>
            <button
              *ngIf="enableEdit && enableEditIndex == i"
              (click)="enableEdit = false; cancel()"
              class="btn"
            >
            <i class="material-icons">
                cancel
                </i>
            </button>
            <button
              *ngIf="enableEdit && enableEditIndex == i"
              (click)="saveSegment()"
              type="submit"
              class="btn"
            >
            <i class="material-icons">
                save
                </i>
            </button>

            <button
              *ngIf="i != enableEditIndex || enableEditIndex == null"
              (click)="enableEditMethod($event, i)"
              class="btn"
            >
              <i class="material-icons">
                edit
              </i>
            </button>
          </td>

          <!-- <td>
            <button
              mat-icon-button
              [matMenuTriggerFor]="menu"
              aria-label="Example icon-button with a menu"
            >
              <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #menu="matMenu">
              <button
                *ngIf="orgunitChild.leaf"
                mat-menu-item
                (click)="onEditChild($event, orgunitChild.id)"
              >
                <mat-icon>edit</mat-icon>
                <span>Edit</span> <mat-icon>details</mat-icon>
                <span>Details</span>
              </button>
              <button
                mat-menu-item
                (click)="onOpenDetails($event, orgunitChild)"
              >
                <mat-icon>details</mat-icon>
                <span>Details</span>
              </button>
              <button
                *ngIf="orgunitChild.leaf"
                mat-menu-item
                (click)="onDeleteChild($event, orgunitChild.id)"
              >
                <mat-icon>delete</mat-icon>
                <span>Delete</span>
              </button>
            </mat-menu>
          </td> -->
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!(organisationUnitChildrenLoaded$ | async)">
    <p><mat-progress-bar mode="query"></mat-progress-bar></p>
    <p>Loading Facilities</p>
  </div>
</div>

<div *ngIf="!(selectedOrganisationUnitStatus$ | async)">
  <!-- <p>select Organisation unit</p> -->
</div>
